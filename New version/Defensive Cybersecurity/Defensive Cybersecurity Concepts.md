## SOC

SOC stands for Security Operation Center and designates a team of cyber security professionals that monitor the network and its systems to detect malicious cyber security events.

It looks for:
- vulnerabilities: in order to fix them and apply a patch
- policy violations: refers to a set of rules required to protect the network
- unauthorized activity
- network intrusions

The main focus is to keep Detection and Response intact, with cybersecurity solution to help them doing that.

They need to have continuous monitoring over the whole company's network and all the systems to monitor them from one centralized location.

After detection, starts the incident response which is explained below.

The SOC relies on three pillars:
 - People
 - Process
 - Technology

### People

A security solution can generate numerous red flags in a SOC environment and cause noise.

The people is therefore there to identify truly harmful activities and start to respond to it.

As a consequence, a SOC team is divided between different responsibilities:

- SOC Analyst Tier 1: Anything detected goes through them first, and they act as the first responders. They perform basic triage to determine if something is truly harmful and report detections through proper channels
- SOC Analyst Level 2: After the first analysis, some extra analysis can be required, which is the job of the second tier analyst. They dive deeper into anlaysis and correlate data from different sources.
- SOC Analyst Tier 3: Level 3 are experiences professionals who proactiely look for threat indicators and provide their support to the incident response team. They generally deal with the phase coming after detection, which is the containment, eradication and recovery
- Security Engineer: While analysts work on security solutions, the engineer will be responsible to configure and deploy them.
- Detection Engineer: Security rules are the corner stone of security solutions as they are used to detect harmful activities. Level 2 and 3 analysts can create such rules directly or a detection engineer can be used to do so
- SOC Manager: manages the SOC processes, follows the team and provides his support. He also reamains in contact with the organization's Chief Information Security Officer (CISCO) to provide updates

Note: these roles can increase or decrease in responsibilities depending on the size and criticality of organizations.

As a visual summary:

![[Pasted image 20250619120545.png]]

### Process

One of the process used as part of a SOC is the incident response and forensics which is explained in more details below. 

#### Alert triage

This is the basis of the SOC team and the first response to any alert. It's all about answering the 5W:

- What
- When
- Where
- Who
- Why

#### Reporting

Simply consists in escalating an alert to an higher-level analyst for a timely response and resolution. The report should discuss the 5W with a thorough analysis with many evidence.

### Technology

The technology portion refers to the technological solutions that are used in order to minimize the SOC team's manual effort to detect and respond to threats.
#### SIEM

SIEM referes to a Security Information and Event management and is a field within computer security that combines as the name suggests SIM (Security Information Management) and SEM (Security Event Management).

It enable real-time analysis of security alerts generated by appplication and network hardware. SIEM are central to SOC.

SIEM can either be software, hardware or a managed service.

The network logs used inside a SIEM can be divided in 2 parts:

- Host-Centric log sources: these logs capture events within or related to the host. A user accessing a file is considered a host-centric log. Windows Event Logs, Sysmon, OSquery are tools that generate some logs.
- Network-Centric Log Sources: they are generated when hosts communicate with each other or access the internet to visit a website. SSH, VPN, HTTP and other similar protocol logs would be considered as netword-centric logs.

Logs can be stored in different location depending on the OS used. More information can be found [[#Log locations|here]].

These logs are then **ingested** by the SIEM. Each SIEM has its own method of ingesting log files but some common methods are:

- Agent / Forwarder: lightweight tool that gets installed in the Endpoint. It captures all important logs and send them to the SIEM

- Syslog: widely used protocol to collect data from various systems like web servers, databases, etc.

- Manual Upload: Some solutions like Splunk allow users to ingest offline data for wuick analysis. Once ingested it is normalized and made available for analysis.

- Port-forwarding: SIEM can be configured to directly listen to a port and the endpoint forwards the data to that listening endpoint.


#### EDR

EDR stands for Endpoint Detection and Response which provides with detailed time and historical visibility of a device activity. It operates on the endpoint level and can carry out automated responses, which can be launched just with a click.

#### EPP

EPP stands for Endpoint Protection Plateform. It is a suite of tools used to secure endpoint devices. It includes anti-virus protection, data encruption, intrusion prevention, data loss prevention and more.

It allows different technologies allowing these benefits to be controlled and monitored from a centralized source, making things easier for IT teams.

Compared to EDR, it focuses on prevention.

#### Firewalls

A firewall purely functions for network security and acts as a barrier between your internal and external networks. It monitors traffic and filters unauthorized traffic.

There exists different types of firewalls.

###### Stateless Firewall

This type of firewall operates on layer 3 and 4 of the OSI model and works by filtering data based on a predefined set of rules regardless of the previous connections. It allows the firewall to process data quickly but does not allow to apply complex policies.

##### Stateful Firewall

Contrary to stateless firewalls, this type takes into account previous connections and stores them in a table. The benefit is that if it has blocked packets for a specific connection, it will know to keep blocking packets from this connection. It operates as well on layers 3 and 4 of the OSI model.

##### Proxy firewall

They act as intermediates between the private network and the Internet, and operate on the layer 7. The requests made by users in a network are forwarded by this proxy after inspection and their IP address are masked to provide anonymity for the internal IP addresses.

##### Next-Generation Firewall

It operates from layer 3 to layer 7 of the OSI model. It offers deep packet inspection and other functionalities, with an intrusion prevention system that blocks malicious activities in real time. They also have SSL/TLS decryption capabilities to inspect the packets and correlate the data with threat intelligence to make appropriate decisions.

##### Rules in firewalls

Rules allow a system administrator to configure settings in order to filter incoming and outgoing traffic.

The basic components of a rule are:

- Source IP address
- Destination IP address
- Port
- Protocol
- Action: action to take upon notification of the elements specified above on a packet
- Direction: defines if the rule applies to incoming or outgoing traffic.

Types of actions include:

- Allow: indicates that the given particular traffic type is permitted

- Deny: traffic inside the roule is blocked, it is essential to deny traffic from suspicious IP addresses

-  Forward: redirects traffic to a different network segment, it is used by firewall that provide such redirect functionality and that act as gateways between different network segments

Based on the direction of the rule or if the Forward action is used, rules are refered a Inbound, Outbound or Forward.

An example of a firewall is the [[(TODO) Windows Defender Firewall]]
#### XDR

XDR stands for Extended Detection and Response. It monitores and mitigates cybersecurity threats. It collects data across various endpoints of the network, and analyzed to prevent cybersecurity collapses and loss of data. It provides end-to-end visibility and integration of different solutions to improve the responsiveness of information security and address disparate tools .

#### SOAR

SOAR stands for Security Orchestartion, Automation and Response. It allows to respond to incidents automatically. it collects inputs monitored by the SOC team and help define incident response activities.

#### IDS/IPS

IDS stands for Intrusion Detection System and IPS for Intrusion prevention system.

Three IDS detection methodologies are generally used:

- Signature-based detection: compares signatures against observed events to identify an incident. it is the most simple because it compares the current unit of activity  (packet/log) using string comparison operations

- Anomaly-based detection: compares a definition of what is considered as normal activity to identify deviations. It is useful to spot previously unknown threats

- Stateful protocol analysis compares determined profiles of generally accepted definitions of benign protocol activity for each protocol against observed events 

Once detected the IPS can do its job of taking action against the detected incident, among which:

- Blocking malicious traffics
- Removing malicious content
- Triggering other security devices
- Enforcing security policies

IDS can be of two types:

- Host Intrusion Detection System (HIDS): they are installed on the host and are responsible for only detection potential security threats associated with that particular host. It provides visibility on the host activities. These systems can be hard to manage over large networks since they are resource-intensive and require management on each host.

- Network Intrusion Detection System (NIDS): they are crucial to detect malicious activities within a whole network, regardless of affected hosts. They monitor traffic of all hosts, and provide a centralized view of the network

One example of IDS is [[Snort]]

### Threat intelligence

Intelligence refers to information we can gather about actual and potential enemies. A threat is any action that can disrupt a system. These informations help the company to prepare against attacks. It is a threat-informed defense.

Intelligence needs data to be processed and analyzed. it comes from local ressources such as network logs and public sources like forums.

Being able to predict possible attacks allow to prepare response strategy.

## Digital Forensics and Incident Response

### Digital Forensics

Forensics is the application of science to investiagte crimes and establish facts. Digital forensics seeks the same goal but on digital systems.

The points of interest from digital forensics teams are:
- file system: analyzing a digital forensics image (low-level copy) reveals many information
- system memory: allows to get an attacker program that was stored in memory only
- system logs: provides information about what has happened during the attack on a system
- network logs: logs of the paket that has transited through the network can help to determine if an attack has occured

There are many sub activities inside Digital Forensics, among which:

- Computer forensics
- Mobile forensics
- Network forensics
- Database forensics
- Cloud forensics
- Email forensics


### Methodology

The National Institute of Standards and Technology defines a general process divided in 4 phases:

- Collection: Consists in listing all the devices on which we will be able to collect data, while making sure that the data is not tampered. It is necessary to maintain a proper documentation of all the collected items with details.

- Examination: The data needs to be filtered so that the data of interest can be extracted. 

- Analysis: Data is analyzed and correlated between different information sources. The goal is to identify events relevant to the case chronologically.

- Reporting: Finally a detailed report is prepared. It contains the investigation's methodology and detailed findings from the collected evidence. It can also contain recommendations. The report is presented to law enforcement and executive management. Executive summaries are required in order to consider all levels of understanding of the different parties.

### Evidence Acquisition

#### Proper authorization

the forensics team need to obtain authorization from relevant authorities before collecting any data. Evidence without prior approval may be deemed inadmissible in court.

#### Chain of custody

The chain of custody allows to bring responsibilties to the teams manipulating the evidence in case some data is lost. It consists in a formal document containing all the details of the evidence, especially
- description: name, type, etc.
- name of the individuals who collected the evidence
- date and time of evidence collection
- storage location of each piece of evidence
- access times and the individual record who accesses the evidence

#### Write blockers

To avoid that background tasks in the forensic station alter the timestamps of the file on a hard drive, write blockers are used so that the hard drive remains in the same state by blocking all alteration attempts.


Windows Forensics: TODO



### Incident Response

An incident refers to a data breach or cyber attack, or something less critical loke a misconfiguration, an intrusion attempt or a policy violation.

Incident response specifies the 
methodology to follow to handle such cases. The aim is to reduce damage and recover in the shortest time possible. It should give a clear and ready plan for incident response.

Two response frameworks exist, defined by the SANS Institute (SysAdmin, Audit, Network and Security, leading organization specializing in cybersecurity training, research and certifications) and the NIST (National Institute of Standards and Technology).

The SANS framework is divided in 6 phases:
- Preparation: building the necessary ressources to handle an incident (having incident response teams, response plans, deploy security solutions, etc.)
- Identification: Looking for abnormal behavior with security solution and monitoring techniques
- Containment: the incident is contained to prevent further damage and minimize the impact.
- Eradication: removes the threat from the attacked environment, and make the environment clean
- Recovery: we recover the systems from backups or rebuild them. They are then tested and declared to be ready to use again.
- Lessons Learned: Gaps in the detection and analysis of the incident are identified, they are documented to help improve the overall process.

The NIST framework has 4 phases:
- Preparation: requires a team trained and ready to handle incidents. Various measures to prevent incidents in the first place
- Detection and Analysis: The team must have the necessary resources to detect incidents to check its severity
- Containment, Eradication and Recovery: Once an incident is detected, it is crucial to stop it from affecting other systems, eliminate it and recover the affected systems. 
- Post-incident Activity: After the incident, a report is produces, and the lessons learned are shared for a better preparation

Some tools and techniques used are: [[#SIEM]], Antivirus, [[#EDR]].

The steps to follow once an incident is detected are gathered in documents called Playbooks.

Runbooks refer to detailed, step-by-step execution of specific steps mentioned inside playbooks


### Types of incidents

There are several incidents possible, among which:

- Malware infections: Malware is a malicious program that can damage a system, network or app. It is dealt with in more details below ([[#Malware Analysis|here]]).

- Security Breaches: They arise when an unauthorized person gets access to confidential data

- Data Leaks: When confidential information of an individual or an organization is exposed to unauthorized entities. It leads to reputational damage and such access can be used to threaten victims. Unlike breaches leaks can be caused by human errors.

- Insider Attacks: refers to incident occurring from within an organization, like an employee infecting the network with a virus.

- Denial of Service Attacks: Availability is one of the pillars of cybersecurity. Data must be accessible to users simultaneously. With DOS, a system is flooded with false requests, making it unavailable to legitimate users because of exhaustion of ressources available.

### Malware Analysis

Malware stands for malicious software, which can be a malicious file, document or program that is saved on a disk over the network.

There are several types of malware:
- Virus: pieces of code that attaches itself to a program and is designed to spread from one computer to another computer. It works by altering, overwriting and deleting files once it infects a computer, making the computer slow or unusable
- Trojan Horse: program that shows one desirable function but hides a malicious one underneath. For example, a video game can hide a function that gives the attacker access to the victim's computer.
- ransomware: malicious program that encrypts the user's files, making them unreadable without knowing the passwd. Then the attacker can request a "ransom", a payment to provide the given passwd.

Two types of analysis exist:
- Static Analysis: works by inspecting the program without running it. It requires solid knowledge of assembly.
- Dynamic analysis: works by running the malware in a controlled environment and monitor its activities.




## Logs

Logs are useful in many key areas:
- Security Events Monitoring
- incident Investigation and Forensics
- Troubleshooting
- Performance Monitoring
- Auditing and Compliance

Several types of logs exist:
- System Logs: useful when troubleshooting issues with the OS
- Security Logs: help monitor security-related activities on a system
- Application Logs: contains specific events related to an application, whether it is an interactive or non-interactive activity
- Audit Logs: provides detailed information on the system changes and user events. They are helpful for compliance requirements and can play a vital role in security monitoring.
- Network Logs: provide information on the outgoing and incoming traffic, they are usefil to troubleshoot network issues
- Access Logs: provides information on the access to different resources, and as well the way they were accessed 



### Log locations

#### Windows Event Logs Analysis

Logs on a Windows system can be accessed using the Event Viewer

Windows OS logs many of the activities. They are stored in log files, each with a specific log category, including:

- Application
- System
- Security

Some other log files are meant to contain the logs of specific applications or actions.

Windows has a built-in app to see logs which is the Event Viewer, providing a GUI to view these logs.

A Windows log has different fields, including:

- Description: detailed information on the activity
- Log Name: log file name
- Logged: time of the activity
- Event ID: unique identifier for a specific activity

Some examples of event ID are:
- 4624: user account successfully logged in
- 4625: user account failed to log in
- 4634: user account logged off
- 4720: user account was created
- 4724: attempt made to reset an account's password
- 4722: user account was enabled
- 4725: user account was disabled
- 4726: user account was deleted

It is possible to filter logs using the `Filter Current Log` according to a chosen Event ID.

### Linux

Some of the most common log locations in Linux are:

- `/var/log/https`: contains HTTP requests/responses and error logs
- `/var/log/cron`: events related to cron jobs
- `/var/log/auth.log` and `/var/log/secure`: stores authentication related logs
- `/var/log/kern`: files storing kernel related events

With web servers, specific log files can be created, for example apache logs can be sometimes stored in `/var/log/apache`.



## Vulnerability scanning

Vulnerability scanning is the inspection of digital systems to find weaknesses, in order to patch them before they can be exploited by attackers and compromise the critical information held by a company.

Doing so is also a requirement of many regulatory bodies, with some standards advising to perform vulnerability scanning quarterly.

After finding vulnerabilities, organisations fix them by making changes to a software or a program. These fixes are called Patches.

Several types of scan exist:

- Authenticated scans: The credentials of the subjects are provided to the vulnerability scanner in ordere to identify the exploits possible once an attacker managed to gain access to the host. It also allows for a more in-depth scanning since it can scan as well the apps installed on the host and their configs.

- Unauthenticated scans: with these scans only the IP addresses of the subjects are given. The scan allows to identify the vulnerabilities that can be exploited by an external attacker. It is less ressource-intesive and straightforward to set up.

- Internal scans: Conducted inside the network, it focuses on exploits possible once an attacker has gained access to a network.

- External scans: Conducted outside the network, it allows to identify exploitable vulns from outside of the network for an attacker.

Some tools for vulnerability scanning are:

- Nessus
- Qualys
- Nexpose
- OpenVAS - Open source

## CVE & CVSS

### CVE

CVE stands for Common Vulnerabilities and Exposures. It was developed by the MITRE Corporation. Whenever a new vulnerability is discovered, it is given a CVE number and is published online in order to make other people aware of the issue.

A CVE number has the following format:

CVE - YEAR - NUMBER

### CVSS

CVSS stands for Common Vulnerability Scoring System. Each CVE has an associated CVSS score that helps to identify the severity of a vulnerability.

There are 4 ranges associated with this score:

- 0.0 - 3.0: Low
- 4.0 - 6.9 : Medium
- 7.0 - 8.9: High
- 9.0 - 10: Critical
